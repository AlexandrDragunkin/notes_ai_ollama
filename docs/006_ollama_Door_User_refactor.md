# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É –±–æ–ª—å—à–æ–≥–æ –ø–∞–∫–µ—Ç–∞ Door_user

## 1. –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ

| –ß—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–¥–µ–ª–∞—Ç—å | –õ—É—á—à–∏–π ¬´–º–æ–¥–µ–ª—å–Ω—ã–π¬ª –ø–æ–¥—Ö–æ–¥ | –ü–æ—á–µ–º—É —ç—Ç–æ —É–¥–æ–±–Ω–æ |
|------------------------|---------------------------|------------------|
| **–ò–∑–º–µ–Ω—è—Ç—å –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–≥—Ä–æ–º–Ω—ã–π –ø–∞–∫–µ—Ç** | **Clean Architecture + Domain‚ÄëDriven Design (DDD)**, –≥–¥–µ –≤ —Ü–µ–Ω—Ç—Ä–µ ‚Äì *—è–¥—Ä–æ* (Domain), –∞ –≤–Ω–µ—à–Ω–∏–µ —Å–ª–æ–∏ ‚Äì *–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ* –∏ *–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞* | –ü–æ–∑–≤–æ–ª—è–µ—Ç ¬´–∑–∞–º–æ—Ä–æ–∑–∏—Ç—å¬ª –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫—É –∏ –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –µ—ë –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—Å–º–µ–Ω–µ –≥—Ä–∞—Ñ–∏–∫–∏, –¥–∞—Ç–∞–±–∞–∑, —Å–µ—Ä–≤–∏—Å–æ–≤ –∏ —Ç.–¥. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å–ª–æ—è–º —É–ø—Ä–æ—â–∞–µ—Ç —é–Ω–∏—Ç‚Äë—Ç–µ—Å—Ç—ã, CI‚Äë–ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã. |
| **–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞** | `ruff` + `black`+`isort`, `mypy` (static typing), `pylint`/`flake8`, `rope` (pycharm), `radon` (complexity) + CI‚Äëpipeline (GitHub Actions/GitLab CI) | –°–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π ¬´–ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —á–µ–∫‚Äë–ª–∏—Å—Ç¬ª: —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ ‚Üí —Ç–µ—Å—Ç—ã ‚Üí CI. |
| **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è/–∞–≤—Ç–æ‚Äë—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥** | **GPT‚Äë4‚ÄØTurbo / GitHub‚ÄëCopilot** (–∏–ª–∏ local `llama.cpp` + fine‚Äëtuned model) | –≠–∫—Å–ø–µ—Ä—Ç‚Äë–ø–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤, –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –≤—ã–Ω–µ—Å–µ–Ω–∏–∏ –∫–æ–¥–∞ –≤ –Ω–æ–≤—ã–µ –ø–∞–∫–µ—Ç—ã, –Ω–æ —á–µ–ª–æ–≤–µ–∫‚Äë–ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞. |

–ù–∏–∂–µ ‚Äî –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ø–ª–∞–Ω, –≥–¥–µ –∏ –∫–∞–∫ –ø—Ä–∏–º–µ–Ω—è—Ç—å –º–æ–¥–µ–ª—å –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.

---

## 2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω ‚Äì Clean Architecture –¥–ª—è ¬´–ø–∞–∫–µ—Ç–∞¬ª

```
myapp/
 ‚îú‚îÄ core/          # Domain (entities, value‚Äëobjects, repository interfaces, services)
 ‚îÇ   ‚îú‚îÄ entities/
 ‚îÇ   ‚îú‚îÄ value_objects/
 ‚îÇ   ‚îú‚îÄ services/
 ‚îÇ   ‚îî‚îÄ ports/          # –ê–¥–∞–ø—Ç–µ—Ä—ã (–∫–æ–Ω—Å–æ–ª—å, API, –ë–î)
 ‚îú‚îÄ app/          # Application (use‚Äëcases, DTO, orchestration)
 ‚îú‚îÄ infra/        # Concrete implementations (ORM, external APIs, file‚Äësystem)
 ‚îú‚îÄ ui/           # CLI / API (FastAPI/Flask, command‚Äëline)
 ‚îî‚îÄ tests/        # –¢–µ—Å—Ç—ã, —É–ø–∏—Ä–∞—è—Å—å –≤–æ —Å–ª–æ–∏ –≤ –ø–æ—Ä—è–¥–∫–µ ¬´domain ‚Üí application ‚Üí infra ‚Üí ui¬ª
```

### 2.1. –ü–æ—á–µ–º—É Clean Architecture —Å—Ç–æ–∏—Ç –≤—ã–±–∏—Ä–∞—Ç—å

| –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ | –ö–∞–∫ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ |
|--------------|-----------------------------------|
| ‚ÄØ**–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —è–¥—Ä–∞** | –ë–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫–∞ (core) –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤. –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –ë–î, UI, –¥–∞–∂–µ —è–∑—ã–∫, –Ω–µ —Ç—Ä–æ–≥–∞—è —è–¥—Ä–æ. |
| ‚ÄØ**–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤** | –¢–µ—Å—Ç—ã –≤ –∫–æ—Ä–Ω–µ ¬´domain¬ª –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å—É—â–Ω–æ—Å—Ç–∏ –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ. |
| ‚ÄØ**–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** | –í ¬´infra¬ª –ø–∞–¥–∞–µ—Ç –≤—Å—ë, —á—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å —Ñ–∞–π–ª–∞–º–∏, —Å–µ—Ç—å—é, —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π. |
| ‚ÄØ**–ü—Ä–æ–µ–∫—Ç–Ω–∞—è –∞–≤—Ç–æ–Ω–æ–º–∏—è** | –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Ä–∞–∑–Ω–µ—Å—Ç–∏ –ø–∞–∫–µ—Ç—ã –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø–æ–¥‚Äë–ø—Ä–æ–µ–∫—Ç—ã –∏–∑ ¬´core¬ª –∫–∞–∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏. |
| ‚ÄØ**–ü—Ä–µ–≤—å—é –∫–æ–¥–∞** | –ù–æ–≤—ã–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—é—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –±—ã—Å—Ç—Ä–µ–µ. |

> **–ü—Ä–∏–∫–ª–∞–¥:** –µ—Å–ª–∏ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äì ¬´—Å–∏—Å—Ç–µ–º–∞ —Ä–∞—Å—á—ë—Ç–∞ –¥–≤–µ—Ä–µ–π¬ª (–ø—Ä–∏–º–µ—Ä–Ω—ã–π –∫–æ–¥ –≤ –≤–æ–ø—Ä–æ—Å–µ), —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å `BaseDoor`, `StraightDoor` –∏ —Ç.–¥. –ü–µ—Ä–µ–Ω–æ—Å–∏–º –≤—Å–µ —ç—Ç–∏ –∫–ª–∞—Å—Å—ã –≤ `core/door`, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –≤ `core/ports`, `StraightDoor` —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è *—Å–µ—Ä–≤–∏—Å–æ–º* –≤ `app/door`, –∞ `ui`/`api` –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –∫ –Ω–µ–º—É —á–µ—Ä–µ–∑ `app`.

---

## 3. –°–∏—Å—Ç–µ–º–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

| –®–∞–≥ | –ß—Ç–æ –¥–µ–ª–∞—Ç—å | –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å |
|-----|------------|--------------|
| 1.  **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑** | –ó–∞–ø—É—Å—Ç–∏—Ç—å `ruff .` ‚Äì —ç—Ç–æ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç `flake8`, `pyproject` –∏ `isort`. | –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π / –æ—à–∏–±–æ–∫. |
| 2.  **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `black .` + `isort .` (–∏–ª–∏ `black --check`). | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ç–∏–ª—å PEP‚Äë8 —Å–æ–±–ª—é–¥—ë–Ω. |
| 3.  **–¢–∏–ø—ã** | –í–∫–ª—é—á–∏—Ç—å `mypy --strict`. | –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ `type‚Äëhints` (dataclasses, TypedDict). |
| 4.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏** | `radon cc *.py` ‚Äì –ø–æ–¥—Å—á—ë—Ç McCabe‚Äëcomplexity. | –£–º–µ–Ω—å—à–∏—Ç—å >10, ¬´extract‚Äëmethod¬ª –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. |
| 5.  **–¢–µ—Å—Ç—ã** | –ü–∏—Å–∞—Ç—å `pytest` ‚Äì –∫–∞–∫ –¥–ª—è ¬´–∫–æ—Ä–Ω—è¬ª (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã—Ö —É—Ç–∏–ª–∏—Ç), —Ç–∞–∫ –∏ –¥–ª—è ¬´core¬ª. | –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `pytest -q` –ø–æ–∫—Ä—ã–≤–∞–µ—Ç 85‚ÄØ%+ –∫–æ–¥–∞. |
| 6.  **CI** | –°–æ–∑–¥–∞—Ç—å GitHub Actions: *Lint ‚Üí Test ‚Üí Build*. | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π `make`‚Äë–ø—Ä–æ–≤–µ—Ä–∫–∞. |
| 7.  **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** | `pipdeptree --freeze` ‚Äì —á—Ç–æ–±—ã –Ω–µ –±—ã–ª–æ ¬´circular imports¬ª. | –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–º–ø–æ—Ä—Ç‚Äë—à–∞–±–ª–æ–Ω—ã, –≤—ã–Ω–µ—Å—Ç–∏ –∏—Ö –≤ `.well-known` / `__init__`. |
| 8.  **–û—Ç–¥–µ–ª–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã** | –í—ã–Ω–µ—Å–∏—Ç–µ –∫–∞–∂–¥—É—é ¬´—Å—Ç–æ—Ä–æ–Ω—É –¥–≤–µ—Ä–∏¬ª –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–ª–∞—Å—Å/–º–æ–¥—É–ª—å, –Ω–∞–ø—Ä–∏–º–µ—Ä: `StraightDoor`, `StandartDoor`, `WingLine`. | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫–∞–∂–¥—ã–π –º–æ–¥—É–ª—å –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ `core`. |
| 9.  **–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ LLM** | –°–æ—Å—Ç–∞–≤—å—Ç–µ ¬´—Å–ø–∏—Å–æ–∫ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤¬ª, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´Extract Class¬ª –¥–ª—è `StandingDoorWingBuilder`). | –ó–∞–ø—É—Å—Ç–∏—Ç—å GPT‚Äë4 ¬´Write Python class for {X}¬ª –∏ –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∏—Ç—å. |
|10. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π** | –ó–∞–ø—É—Å—Ç–∏—Ç–µ `pytest`, `ruff`, `mypy`. | –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ regressions. |

> **–ü—Ä–æ–±–ª–µ–º—ã –≤ –ø—Ä–∏–º–µ—Ä–µ**  
> *–ù–µ–∑–∞–≤–∏—Å–∏–º–∞—è `priceinfo`*, *–º–∏–∫—Å `globals()` –∏ `__dict__`*, *–≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ*, `class`‚Äë–æ–±—ä–µ–∫—Ç—ã –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏, `typing` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è.  
> –û–ø–∏—Å–∞–Ω–∏–µ *—Å—Ç–æ—Ä–æ–Ω—ã –¥–≤–µ—Ä–∏* (OPENSIDE, HNDMac) –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ `core.value_objects`.  
> –í—Å—ë –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∏–º–ø–æ—Ä—Ç–æ–≤ –º–æ–∂–Ω–æ —Ä–∞–∑–±—Ä–æ—Å–∞—Ç—å, —Ç–∞–∫ —á—Ç–æ `__init__`‚Äë–º–æ–¥—É–ª–∏ –±—É–¥—É—Ç ¬´–º—è–≥–∫–∏–º–∏¬ª.

---

## 4. –ü—Ä–∏–º–µ—Ä—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Å—Ç–æ–∏—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å

### 4.1. **Port & Adapter**
`core/ports/repository.py`  
```python
class DoorRepository(Protocol):
    def find_by_id(self, door_id: int) -> Door: ...
    def save(self, door: Door) -> None: ...
```
`infra/orm/knox.py`  
```python
class KnoxDoorRepository(DoorRepository):
    def find_by_id(self, door_id: int):
        # ORM‚Äë–∑–∞–ø—Ä–æ—Å...
```

### 4.2. **Use‚ÄëCase (Application service)**
```python
class CreateStandardDoor:
    def __init__(self, repo: DoorRepository, logger: Logger):
        self.repo = repo
        self.logger = logger

    def __call__(self, dto: DoorDto) -> DoorDto:
        door = StandardDoor.from_dto(dto)
        self.repo.save(door)
        self.logger.info(f"Door {door.id} created")
        return door.to_dto()
```

### 4.3. **Factory for building fa√ßade**
```python
class FacadeFactory:
    def create(self, door: Door, facadetype: str) -> Facade:
        if facadetype == "wing":
            return WingFacade(door)
        else:
            return StandardFacade(door)
```

### 4.4. **Strategy Pattern –¥–ª—è –≤—ã–±–æ—Ä–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞**
```python
class HingeStrategy(Protocol):
    def build(self, door: Door) -> List[Hinge]: ...

class StandardHingeStrategy(HingeStrategy): ...
class CornerHingeStrategy(HingeStrategy): ...

class HingeBuilder:
    def __init__(self, strategy: HingeStrategy):
        self.strategy = strategy

    def build(self, door: Door) -> List[Hinge]:
        return self.strategy.build(door)
```

---

## 5. –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

| –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç | –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å |
|------------|------------|-----------------|
| **PyCharm / VSCode (–ø–ª–∞–≥–∏–Ω)** | Refactor ‚Üí Extract Method / Class, Move | IDE‚Äë—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ ¬´–ø–æ‚Äë–∂–∏–≤—É¬ª. |
| **rope** (CLI) | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å ¬´Extract Class¬ª | `rope extract-class --source mymodule.py --destination core/door/newclass.py` |
| **black & isort** | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞ | `black . && isort .` |
| **ruff** | Linter + formatter | `ruff check --fix .` |
| **mypy** | –¢–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ | `mypy --strict .` |
| **radon** | –°–ª–æ–∂–Ω–æ—Å—Ç—å McCabe | `radon cc -a myapp/` |
| **pytest** | Unit‚Äë—Ç–µ—Å—Ç—ã | `pytest -s -vv` |
| **pipenv / poetry** | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ | `poetry add`/`pipenv install` |
| **git diff-filter** | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –∏–º–ø–æ—Ä—Ç–æ–≤ | `git blame` |
| **GitHub Actions** | CI‚Äëpipeline | `.github/workflows/ci.yml` —Å lint, test, build |
| **Dependabot** | –ê–≤—Ç–æ‚Äë–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | –í–∫–ª—é—á–∏—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π |
| **GPT‚Äë4 Turbo (openai)** | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞, refactoring prompts | –ù–∞–ø–∏—Å–∞—Ç—å prompt ¬´–í—ã–Ω–µ—Å–∏ –∏–∑ –º–æ–¥—É–ª—é X –≤—Å–µ –∫–ª–∞—Å—Å—ã Y¬ª |

–ü—Ä–∏–º–µ—Ä CI‚Äë–ø–∞–π–ø–ª–∞–π–Ω–∞ (GitHub Actions):

```yaml
name: ci

on:
  push:
  pull_request:

jobs:
  lint-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"
          cache: pip
      - name: Install deps
        run: pip install -r requirements.txt
      - name: Ruff
        run: ruff check --fix .
      - name: Black
        run: black --check .
      - name: Isort
        run: isort --check .
      - name: Mypy
        run: mypy .
      - name: Tests
        run: pytest --cov=.

```

---

## 6. –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LLM –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ ¬´—Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π¬ª**  
   * ¬´–í—ã–Ω–µ—Å—Ç–∏ –≤—Å–µ –∫–ª–∞—Å—Å—ã, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ —Å —Ñ–∞—Å–∞–¥–∞–º–∏, –≤ –ø–∞–∫–µ—Ç `core/door/`¬ª  
   * ¬´–ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –º–µ—Ç–æ–¥—ã `GetHandle` –∏ `SetHandle` –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å `HandlingService`¬ª  

2. **–ü—Ä–æ–º–ø—Ç**  
   ```
   Given a Python file that contains many unrelated classes and functions,
   refactor it so that all door‚Äërelated entities live in a new package
   `core/door`.  Extract `StraightDoor`, `StandartDoor`, `WingLine` into that
   package.  Also extract the hinge builder into `core/door/hinge.py`.  Keep
   type hints, docstrings, and tests unchanged.  Return the patch.
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç**  
   * –ü—Ä–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è.  
   * –ó–∞–ø—É—Å—Ç–∏—Ç–µ `pytest`.  
   * –°—Ä–∞–≤–Ω–∏—Ç–µ diff —Å `ruff`.  

> **–í–∞–∂–Ω–æ** ‚Äì LLM –º–æ–∂–µ—Ç –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏—è –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –Ω–æ **–≤—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ**. –û–Ω –Ω–µ –≤–∏–¥–∏—Ç `git`‚Äë—Å—Ç–∞—Ç—É—Å –∏ –∂–∏–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

---

## 7. –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —á–µ–∫‚Äë–ª–∏—Å—Ç –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –±–æ–ª—å—à–∏—Ö –ø–∞–∫–µ—Ç–æ–≤

| –ó–∞–¥–∞—á–∞ | –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|--------|----------------|-----------|
| **–°–æ–±—Ä–∞—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥** | `git ls-files '*.py'` | –°–¥–µ–ª–∞–π—Ç–µ ¬´dump¬ª –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π. |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ—Å—Ç–æ–≤** | `pytest --maxfail=1` | –ï—Å–ª–∏ —Ç–µ—Å—Ç–æ–≤ –º–∞–ª–æ ‚Äì –Ω–∞–ø–∏—à–∏—Ç–µ ¬´—É–≥–ª–æ–≤—ã–µ¬ª cases. |
| **–ù–∞–π—Ç–∏ ¬´–≥–æ—Ä—è—á–∏–µ¬ª –º–æ–¥—É–ª–∏** | `radon cc` + `pylint` | –£–ø–æ—Ä–∏—Ç—å—Å—è –Ω–∞ —Ñ–∞–π–ª–∞—Ö > 30 LOC —Å–ª–æ–∂–Ω–æ—Å—Ç–∏. |
| **–ò–∑–º–µ–Ω–∏—Ç—å –∏–º–ø–æ—Ä—Ç‚Äë–ø–æ—Ä—è–¥–æ–∫** | `isort` | –ó–∞—â–∏—Ç–∏—Ç—å –æ—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. |
| **–í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫—É –≤ core** | **refactor ‚Üí Extract Class** | –£–¥–∞–ª–∏—Ç—å –ª–∏—à–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏. |
| **–°–æ–∑–¥–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã** | –ù–∞–ø–∏—Å–∞—Ç—å `Service`-–∫–ª–∞—Å—Å—ã –≤ `app/` | –û—Ç–¥–µ–ª–∏—Ç—å –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫–∏ –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. |
| **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏** | –°–æ–∑–¥–∞—Ç—å `core/ports/repository.py`. | –ò–Ω–≤–µ—Ä—Å–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. |
| **–ù–∞–¥–æ–∏—Ç—å —Ç–∏–ø—ã** | `mypy --strict`. | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π. |
| **–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å CI** | –°–æ–∑–¥–∞—Ç—å GitHub Actions. | –ü—Ä–æ–≤–µ—Ä–∫–∞ `ruff`, `pytest`, `mypy` | 
| **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å** | `pdoc`, `mkdocs`. | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å API‚Äë–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é. |
| **–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö** | Write migration scripts (alembic) | –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å—è—Ç—Å—è. |
| **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** | –ë—ç–∫—Ç–µ—Å—Ç—ã: run old code + new code side‚Äëby‚Äëside. | –û—Å—Ç–∞–≤—å—Ç–µ `legacy`‚Äë–ø–æ–¥—Å–∏—Å—Ç–µ–º–∞, –µ—Å–ª–∏ –Ω—É–∂–Ω–æ. |

---

## 8. –ö—Ä–∞—Ç–∫–æ–µ ¬´–ø—Ä–æ—à–µ–¥—à–µ–µ¬ª –∏ –≥–¥–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å AI

| –ß—Ç–æ | –ö–∞–∫ AI –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å | –ß—Ç–æ –¥–µ–ª–∞—Ç—å |
|-----|---------------------|------------|
| –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª–∞—Å—Å–æ–≤ –ø–æ –ø–∞—Ç—Ç–µ—Ä–Ω—É | GPT‚Äë4 + ¬´extract‚Äëclass¬ª prompt | –°–æ–∑–¥–∞—Ç—å —à–∞–±–ª–æ–Ω—ã, –ø–æ—Ç–æ–º –ø–æ–ø—Ä–∞–≤–∏—Ç—å –≤—Ä—É—á–Ω—É—é |
| –ü–µ—Ä–µ–Ω–æ—Å –º–µ—Ç–æ–¥a –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å | prompt ¬´Move method X to class Y¬ª | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—ã–∑–æ–≤—ã –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| –ü–µ—Ä–µ–≤–æ–¥ legacy‚Äë–∫–æ–¥–∞ –≤ `type‚Äëannotated` | AI‚Äë–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π | –ó–∞–ø—É—Å–∫ `mypy` –ø–æ—Å–ª–µ |
| –ê–≤—Ç–æ‚Äë—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ | GPT‚Äë4 + `requirements.txt` | –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å `pyproject.toml` + `poetry.lock` |

> **–ó–∞–º–µ—á–∞–Ω–∏–µ:** AI —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ, –Ω–æ **–Ω–µ –∑–∞–º–µ–Ω—è–µ—Ç** —á–µ–ª–æ–≤–µ–∫‚Äë—Ç–µ—Å—Ç–µ—Ä. –ü—Ä–æ–≤–æ–¥–∏—Ç–µ `code review`, `tests`, `CI` –ø–æ—Å–ª–µ –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏.  

---

## 9. –ò—Ç–æ–≥–∏

1. **–†–∞–∑–±–µ–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–ª–æ–∏** (`core ‚Üí app ‚Üí infra ‚Üí ui`).  
2. **–ü–æ—Å—Ç–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞**: `black`, `ruff`, `mypy`, unit‚Äë—Ç–µ—Å—Ç—ã, CI.  
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã**: Repository, Service, Factory, Strategy, Adapter.  
4. **–í—ã–Ω–µ—Å–∏—Ç–µ –±–∏–∑–Ω–µ—Å‚Äë–ª–æ–≥–∏–∫—É –≤ `core`** –∏ –¥–µ—Ä–∂–∏—Ç–µ –µ—ë –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–π.  
5. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä—É–π—Ç–µ —Ä—É—Ç–∏–Ω–Ω—ã–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∏** —á–µ—Ä–µ–∑ `rope`, `pycharm`, `LLM`.  
6. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é** –ø—Ä–∏ –ø–æ–º–æ—â–∏ `alembic` –∏–ª–∏ —Ä—É—á–Ω—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤.  
7. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è** ‚Äì API, ¬´—á–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è¬ª –æ—Ç —Å—Ç–∞—Ä–æ–π –º–æ–¥–µ–ª–∏, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å.  

–° —Ç–∞–∫–∏–º –ø–æ–¥—Ö–æ–¥–æ–º –ª—é–±—ã–µ —Å—Ç–∞—Ä—ã–µ –ø–∞–∫–µ—Ç—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å, —É–ª—É—á—à–∏—Ç—å —á–∏—Ç–∞–µ–º–æ—Å—Ç—å, –ø–æ–≤—ã—Å–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏ –∏ –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –±—É–¥—É—â–∏–º–∏ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞–º–∏ ‚Äî –∏ –≤—Å—ë —ç—Ç–æ –±–µ–∑ ¬´—à—É–º–Ω–æ–≥–æ¬ª –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –∫–æ–¥–∞ –≤—Ä—É—á–Ω—É—é. üöÄ

## 10. –ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–∫–µ—Ç–∞

```
doorsys/
‚îú‚îÄ‚îÄ core/                           # –ß–∏—Å—Ç–∞—è –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ domain/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ entities/              # –°—É—â–Ω–æ—Å—Ç–∏ (Door, Facade, Hinge)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ value_objects/         # Value Objects (Dimensions, HingeType)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/              # Domain Services
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ repositories.py        # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
‚îÇ   ‚îî‚îÄ‚îÄ application/
‚îÇ       ‚îú‚îÄ‚îÄ use_cases/             # Use Cases
‚îÇ       ‚îú‚îÄ‚îÄ dto/                   # Data Transfer Objects
‚îÇ       ‚îî‚îÄ‚îÄ services/              # Application Services
‚îú‚îÄ‚îÄ infrastructure/                 # –†–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ persistence/               # –†–∞–±–æ—Ç–∞ —Å –ë–î, K3
‚îÇ   ‚îú‚îÄ‚îÄ external/                  # –í–Ω–µ—à–Ω–∏–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ config/                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ interfaces/                    # –í–Ω–µ—à–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ api/                       # REST API
‚îÇ   ‚îú‚îÄ‚îÄ cli/                       # –ö–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞
‚îÇ   ‚îî‚îÄ‚îÄ web/                       # Web –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îî‚îÄ‚îÄ shared/                        # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
    ‚îú‚îÄ‚îÄ utils/
    ‚îî‚îÄ‚îÄ exceptions/
```

## 11. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–æ–≤

### 11.1. –í—ã–Ω–µ—Å—Ç–∏ Value Objects

```python
# core/domain/value_objects/door_config.py
from dataclasses import dataclass
from enum import Enum
from typing import Tuple

class Hinge4Type(Enum):
    INV = 1    # –ù–∞–∫–ª–∞–¥–Ω–∞—è
    HINV = 2   # –ü–æ–ª—É–Ω–∞–∫–ª–∞–¥–Ω–∞—è
    INS = 3    # –í–∫–ª–∞–¥–Ω–∞—è

@dataclass(frozen=True)
class HingeOpenType:
    htype: Hinge4Type
    minspace: float
    maxspace: float

@dataclass(frozen=True)
class DoorDimensions:
    width: float
    depth: float  
    height: float
    
@dataclass(frozen=True)
class DoorSpacing:
    right: float
    left: float
    top: float
    bottom: float
    double: float

# core/domain/value_objects/door_constants.py
class DoorConstants:
    OPENSIDE_LEFT = "Left"
    OPENSIDE_RIGHT = "Right" 
    OPENSIDE_TOP = "Top"
    OPENSIDE_BOTTOM = "Bottom"
    OPENSIDE_NONE = "None"
```

### 11.2. –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏

```python
# core/domain/entities/door.py
from abc import ABC
from dataclasses import dataclass
from typing import List, Optional
from .value_objects import DoorDimensions, DoorSpacing, Hinge4Type

@dataclass
class Door(ABC):
    id: Optional[int] = None
    dimensions: Optional[DoorDimensions] = None
    spacing: Optional[DoorSpacing] = None
    hinge_type: Optional[Hinge4Type] = None
    opening_side: str = ""
    
    def calculate_real_dimensions(self) -> DoorDimensions:
        # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ä–∞–∑–º–µ—Ä–æ–≤
        pass

# core/domain/entities/straight_door.py
@dataclass 
class StraightDoor(Door):
    door_type: str = "straight"
    is_assembly: bool = True
    auto_hinges: bool = True
    
    def validate_construction(self) -> bool:
        # –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –¥–ª—è –ø—Ä—è–º—ã—Ö –¥–≤–µ—Ä–µ–π
        pass
```

### 11.3. –°–æ–∑–¥–∞—Ç—å Domain Services

```python
# core/domain/services/door_calculator.py
class DoorCalculator:
    @staticmethod
    def calculate_hinge_positions(door: Door, facade_height: float) -> List[float]:
        # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–∑–∏—Ü–∏–π –ø–µ—Ç–µ–ª—å
        pass
    
    @staticmethod
    def calculate_facade_dimensions(door: Door) -> Tuple[float, float]:
        # –õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ —Ä–∞–∑–º–µ—Ä–æ–≤ —Ñ–∞—Å–∞–¥–∞
        pass

# core/domain/services/door_validator.py  
class DoorValidator:
    @staticmethod
    def validate_hinge_clearance(hinge_type: Hinge4Type, spacing: float) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ —Å–≤–µ—Å–∞ –ø–µ—Ç–ª–∏"""
        hinge_space = HingeSpaceType.get(hinge_type)
        return hinge_space.minspace <= spacing < hinge_space.maxspace
```

### 11.4. Use Cases (Application Layer)

```python
# core/application/use_cases/create_door.py
from typing import Protocol
from core.domain.entities import Door
from core.application.dto import DoorDTO

class DoorRepository(Protocol):
    def save(self, door: Door) -> None: ...
    def find_by_id(self, door_id: int) -> Door: ...

class CreateDoorUseCase:
    def __init__(self, door_repo: DoorRepository, validator: DoorValidator):
        self.door_repo = door_repo
        self.validator = validator
    
    def execute(self, door_dto: DoorDTO) -> Door:
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–≤–µ—Ä–∏
        door = self._create_door_from_dto(door_dto)
        if self.validator.validate(door):
            self.door_repo.save(door)
            return door
        raise ValueError("Invalid door configuration")
```

### 11.5. –§–∞–±—Ä–∏–∫–∏ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

```python
# core/domain/factories/door_factory.py
class DoorFactory:
    @staticmethod
    def create_door(door_type: str, config: dict) -> Door:
        if door_type == "straight":
            return StraightDoorFactory.create(config)
        elif door_type == "standard":
            return StandardDoorFactory.create(config)
        elif door_type == "wingline":
            return WingLineFactory.create(config)
        raise ValueError(f"Unknown door type: {door_type}")

class StraightDoorFactory:
    @staticmethod
    def create(config: dict) -> StraightDoor:
        dimensions = DoorDimensions(
            width=config['w'], 
            depth=config['d'], 
            height=config['h']
        )
        return StraightDoor(dimensions=dimensions, **config)
```

## 12. –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –≤–∞—à–µ–≥–æ –∫–æ–¥–∞

### 12.1. –£–±—Ä–∞—Ç—å God Class `StandartDoor`

–†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞:

- `DoorSpecification` - –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–≤–µ—Ä–∏
- `DoorConstructor` - –ª–æ–≥–∏–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è  
- `DoorValidator` - –ø—Ä–æ–≤–µ—Ä–∫–∏
- `DoorRenderer` - –æ—Ç—Ä–∏—Å–æ–≤–∫–∞

### 12.2. –í—ã–Ω–µ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç K3

```python
# infrastructure/persistence/k3_adapter.py
class K3DoorRepository:
    def __init__(self, k3_connection):
        self.k3 = k3_connection
    
    def save(self, door: Door) -> None:
        # –ê–¥–∞–ø—Ç–µ—Ä –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ K3
        k3_data = self._convert_to_k3_format(door)
        self.k3.save_door(k3_data)
    
    def _convert_to_k3_format(self, door: Door) -> dict:
        # –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –≤ —Ñ–æ—Ä–º–∞—Ç K3
        pass
```

### 12.3. –£–ª—É—á—à–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

```python
# shared/exceptions/door_exceptions.py
class DoorConstructionError(Exception):
    pass

class InvalidHingeConfigurationError(DoorConstructionError):
    pass

class FacadeDimensionError(DoorConstructionError):
    pass
```

### 12.4. –î–æ–±–∞–≤–∏—Ç—å —Ç–∏–ø–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

```python
# core/domain/value_objects/door_config.py
from pydantic import BaseModel

class DoorConfig(BaseModel):
    proto_id: int
    furn_type: str
    mater_id: int
    hinge_config: HingeConfig
    handle_config: HandleConfig
    
    class Config:
        frozen = True  # Immutable
```

## 13. –ü—Ä–∏–º–µ—Ä —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç–æ–¥–∞ `Make()`

**–ë—ã–ª–æ:**

```python
def Make(self):
    # 100+ —Å—Ç—Ä–æ–∫ —Å–º–µ—à–∞–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏
    objects = []
    self._SetAddVars()
    self._VerifyExceptions()
    # ... —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è
```

**–°—Ç–∞–ª–æ:**

```python
# core/application/services/door_assembly_service.py
class DoorAssemblyService:
    def __init__(self, 
                 hinge_builder: HingeBuilder,
                 facade_builder: FacadeBuilder,
                 handle_builder: HandleBuilder):
        self.hinge_builder = hinge_builder
        self.facade_builder = facade_builder  
        self.handle_builder = handle_builder
    
    def assemble_door(self, door: Door) -> List[DoorComponent]:
        components = []
        
        # –§–∞—Å–∞–¥
        facade = self.facade_builder.build(door)
        components.append(facade)
        
        # –ü–µ—Ç–ª–∏
        hinges = self.hinge_builder.build(door, facade)
        components.extend(hinges)
        
        # –†—É—á–∫–∏
        handles = self.handle_builder.build(door, facade)
        components.extend(handles)
        
        return components

# core/application/use_cases/create_door_assembly.py
class CreateDoorAssemblyUseCase:
    def execute(self, door_id: int) -> DoorAssembly:
        door = self.door_repo.find_by_id(door_id)
        components = self.assembly_service.assemble_door(door)
        return DoorAssembly(door=door, components=components)
```

## 14. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å** - Domain —Å–ª–æ–π –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ
2. **–ó–∞–º–µ–Ω–∞ K3** - –ú–æ–∂–Ω–æ –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å K3 –Ω–∞ –¥—Ä—É–≥—É—é –ë–î
3. **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ù–æ–≤—ã–µ —Ç–∏–ø—ã –¥–≤–µ—Ä–µ–π —á–µ—Ä–µ–∑ Factory
4. **–ß–∏—Ç–∞–µ–º–æ—Å—Ç—å** - –ö–∞–∂–¥—ã–π –∫–ª–∞—Å—Å –∏–º–µ–µ—Ç –æ–¥–Ω—É –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å
5. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤** - Pydantic –º–æ–¥–µ–ª–∏ –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

## 15. –ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

1. **–§–∞–∑–∞ 1**: –í—ã–Ω–µ—Å—Ç–∏ Value Objects –∏ Entities
2. **–§–∞–∑–∞ 2**: –°–æ–∑–¥–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤  
3. **–§–∞–∑–∞ 3**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å Use Cases
4. **–§–∞–∑–∞ 4**: –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–ª—è K3
5. **–§–∞–∑–∞ 5**: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–ª–∞—Å—Å—ã –∏—Å–ø–æ–ª—å–∑—É—è –Ω–æ–≤—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É

–¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –ø–æ–∑–≤–æ–ª–∏—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã –≤–æ –≤—Ä–µ–º—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —É–ª—É—á—à–∞—Ç—å –∫–æ–¥.
